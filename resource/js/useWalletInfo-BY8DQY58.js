import{U as e,H as a,W as s,b as n,I as o,G as t}from"./vue-DH2RNpQ3.js";import{v as l,d as u,U as r,M as i,N as v,a2 as _,e as d,f as g}from"./index-30tzVDQE.js";const h=e("walletInfo",{state:()=>({showDeposit:!1,showWithdraw:!1,showRedeemCode:!1,showAddBank:!1,showDialogTransfer:!1,showTransfer:{method:"in",from:"",to:""}}),actions:{setShowDeposit(e){this.showDeposit=e},setShowWithdraw(e){this.showWithdraw=e},setShowRedeemCode(e){this.showRedeemCode=e},setShowAddBank(e){this.showAddBank=e},setDialogShowTransfer(e){this.showDialogTransfer=e},setShowTransfer(e="",a="",s=""){this.showTransfer.method=e,this.showTransfer.from=a,this.showTransfer.to=s}}}),m=()=>{const e=a(),m=a(),{t:f}=l.useI18n(),c=h(u),p=r(u),{info:w,roleInfo:y}=s(p),T=a(!1),b=a(!1),k=a(),M=a(!1),q=a(Number(y.value.money)),S=a(Number(y.value.bank_money)),E=a("out"),R=a(),I=a(!1),W=a("0%"),x=a(),A=a=>{console.log(w.value,"--------",a),x.value=a,console.log("=====",y.value),x.value.bank_card_info_list&&0!=x.value.bank_card_info_list.length&&w.value.mobile&&y.value.withdraw_pwd?m.value.openModal():e.value.openModal()},D=()=>{const e=d.req_bank_take();e.money=R.value,g.instance.sendRequest(e)},B=e=>{setTimeout((()=>{T.value=!1}),300),1===e.is_success?(R.value=0,_.success(f("proxy_page_caoZuo"))):_.danger(f("proxy_page_caoZuoFail"))},F=()=>{const e=d.req_bank_save();e.money=R.value,g.instance.sendRequest(e)},Z=e=>{setTimeout((()=>{T.value=!1}),300),1===e.is_success?(R.value=0,_.success(f("proxy_page_caoZuo"))):_.danger(f("proxy_page_caoZuoFail"))},C=e=>{console.log("-----是否自动跟随",e),b.value=1===e.auto_trans,T.value=!1},N=()=>{const e=d.req_roleinfo_with_id();e.id=y.value.id,g.instance.sendRequest(e)},j=n((()=>"in"===E.value?q.value>0:S.value>0));return o((()=>{i.addMsgEvent(v.msgType.msg_notify_auto_trans,C),i.addMsgEvent(v.msgType.msg_notify_bank_card_info_list,A),i.addMsgEvent(v.msgType.msg_notify_bank_take_result,B),i.addMsgEvent(v.msgType.msg_notify_bank_save_result,Z),setTimeout((()=>(()=>{const e=d.req_auto_trans(),a=d.req_roleinfo_with_id();g.instance.sendRequest(e),g.instance.sendRequest(a)})()),500)})),t((()=>{i.removeMsgEvent(v.msgType.msg_notify_auto_trans,null),i.removeMsgEvent(v.msgType.msg_notify_bank_card_info_list,null),i.removeMsgEvent(v.msgType.msg_notify_bank_take_result,null),i.removeMsgEvent(v.msgType.msg_notify_bank_save_result,null)})),{loading:T,gameMoney:q,bankMoney:S,eyeOpen:I,showWithdrawModal:e=>c.setShowWithdraw(e),userInfo:w,roleInfo:y,updateAuto:b,refreshWallet:()=>{M.value||(clearTimeout(k.value),M.value=!0,N(),k.value=setTimeout((()=>{M.value=!1}),1e3))},refreshFlag:M,goToWithdraw:()=>{(()=>{const e=d.req_bank_card_info_list();g.instance.sendRequest(e)})()},myBankList:x,tranType:E,changeTranType:e=>{E.value=e},tranMoney:R,chooseMoneyArr:[{label:"100,000",value:1e5},{label:"200,000",value:2e5},{label:"500,000",value:5e5},{label:"1,000,000",value:1e6},{label:"10,000,000",value:1e7}],allTranferMon:()=>{"in"===E.value?R.value=q.value:R.value=S.value},formatTooltip:e=>("in"===E.value?R.value=parseInt(String(q.value*e/100)):R.value=parseInt(String(S.value*e/100)),W.value=`${e}%`,W.value),handleSubmit:()=>{if(!R.value)return _.danger(f("transfer_page_inputAmount"));if("in"===E.value){if(R.value>q.value)return _.danger(f("transfer_page_notEnough"))}else if(R.value>S.value)return _.danger(f("transfer_page_notEnough"));T.value=!0,"in"===E.value?F():D()},slideStr:W,chooseFastMon:e=>{R.value=e},calibrationRef:e,withdrawMoneyRef:m,changeEyeOpen:e=>{I.value=e},canSlide:j,resetTranMoney:()=>{R.value=0}}};export{m as u};