import{Z as e,B as a,_ as l,c as n,ac as t,v as s,M as i,N as o,s as c,e as _,f as d,O as u,Q as r,t as m,R as p,b as v,q as g}from"./index-30tzVDQE.js";import{_ as b}from"./Btn-BQ5zHeyl.js";import{u as f,z as k,o as y,a as h,m as M,g as x,e as B,t as w,j as T,r as C,F as N,S,n as j,f as I,d as A,H as O,x as q,I as E,G as L,B as V,i as z,l as P,p as $,v as R,_ as Z,$ as D}from"./vue-DH2RNpQ3.js";import{c as F}from"./chooseBankDialog-DCdFUwvW.js";var U=Object.defineProperty,G=Object.defineProperties,H=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,K=(e,a,l)=>a in e?U(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l;const{create:X}=n("action-sheet"),Y=X({components:{NutPopup:e,Loading:a},props:(ee=((e,a)=>{for(var l in a||(a={}))W.call(a,l)&&K(e,l,a[l]);if(Q)for(var l of Q(a))J.call(a,l)&&K(e,l,a[l]);return e})({},t),ae={cancelTxt:{type:String,default:""},optionTag:{type:String,default:"name"},optionSubTag:{type:String,default:"subname"},chooseTagValue:{type:String,default:""},title:{type:String,default:""},color:{type:String,default:"#ee0a24"},description:{type:String,default:""},menuItems:{type:Array,default:()=>[]},closeAbled:{type:Boolean,default:!0}},G(ee,H(ae))),emits:["cancel","close","choose","update:visible"],setup:(e,{emit:a})=>({slotDefault:!!f().default,isHighlight:a=>e.chooseTagValue&&e.chooseTagValue===a[e.optionTag]?e.color:"",cancelActionSheet:()=>{a("cancel"),a("update:visible",!1)},chooseItem:(e,l)=>{e.disable||e.loading||(a("choose",e,l),a("update:visible",!1))},close:l=>{e.closeAbled&&(a("close",l),a("update:visible",!1))}})});var ee,ae;const le={class:"nut-action-sheet"},ne={key:0,class:"nut-action-sheet__title"},te={key:1},se={key:0,class:"nut-action-sheet__item nut-action-sheet__desc"},ie={key:1,class:"nut-action-sheet__menu"},oe=["onClick"],ce={key:1},_e={class:"nut-action-sheet__subdesc"};const de=l(Y,[["render",function(e,a,l,n,t,s){const i=k("Loading"),o=k("nut-popup");return y(),h(o,{visible:e.visible,position:"bottom",round:"","close-on-click-overlay":e.closeAbled,"lock-scroll":e.lockScroll,"z-index":e.zIndex,onClickOverlay:e.close},{default:M((()=>[x("view",le,[e.title?(y(),B("view",ne,w(e.title),1)):T("",!0),C(e.$slots,"default"),e.slotDefault?T("",!0):(y(),B("view",te,[e.description?(y(),B("view",se,w(e.description),1)):T("",!0),e.menuItems.length?(y(),B("view",ie,[(y(!0),B(N,null,S(e.menuItems,((a,l)=>(y(),B("view",{key:l,class:j(["nut-action-sheet__item",{"nut-action-sheet__item--disabled":a.disable,"nut-action-sheet__item--loading":a.loading}]),style:I({color:e.isHighlight(a)||a.color}),onClick:n=>e.chooseItem(a,l)},[a.loading?(y(),h(i,{key:0})):(y(),B("view",ce,w(a[e.optionTag]),1)),x("view",_e,w(a[e.optionSubTag]),1)],14,oe)))),128))])):T("",!0),e.cancelTxt?(y(),B("view",{key:2,class:"nut-action-sheet__cancel",onClick:a[0]||(a[0]=(...a)=>e.cancelActionSheet&&e.cancelActionSheet(...a))},w(e.cancelTxt),1)):T("",!0)]))])])),_:3},8,["visible","close-on-click-overlay","lock-scroll","z-index","onClickOverlay"])}]]),ue=e=>(Z("data-v-ef63572a"),e=e(),D(),e),re={class:"addBank_sm_modal"},me={class:"body vertical center body_sec"},pe={class:"flex space_between add_title"},ve={class:"flex space_between choose_bank"},ge={class:"flex align_center choose_bank_l"},be={key:0,class:"bank_cicon"},fe=["src","alt"],ke={class:"bank_cname"},ye={class:"btn_zone flex"},he={class:"cz-tips"},Me={class:"flex align_center justify_center tip"},xe=ue((()=>x("span",{class:"icon"},null,-1))),Be={key:0,class:"flex align_center bottom_tip"},we=ue((()=>x("span",{class:"gth-icon"},null,-1))),Te=v(A({__name:"AddBank",props:{myBankName:{type:String,default:()=>""},myBankList:{type:Array,default:()=>[]}},emits:["getMyBindBankList"],setup(e,{expose:a,emit:l}){const n=l,t=e,{t:v}=s.useI18n(),g=O(!1),b=O(),f=O({bank:"",cardNo:"",name:"",code:""}),k=O(!1),h=O({label:"",value:""}),C=()=>f.value.bank?f.value.cardNo?f.value.name?void N():c.fail(v("paymentManagement_page_chName")):c.fail(v("paymentManagement_page_chCardNo")):c.fail(v("paymentManagement_page_chBank")),N=()=>{const e=_.req_new_bank_card_info();e.bank_id=f.value.bank,e.account_number=f.value.cardNo,e.cardholder_name=f.value.name,d.instance.sendRequest(e)},S=e=>{1===e.result?(j(),n("getMyBindBankList"),c.success(v("paymentManagement_page_addBankSuc"))):c.fail(v("paymentManagement_page_addBankFail"))},j=()=>{g.value=!1},I=()=>{b.value.onCloseBank()},A=e=>{f.value.bank=e.value,h.value=e};return q((()=>g.value),(e=>{e&&(f.value.bank="",f.value.cardNo="",h.value={label:"",value:""})})),E((()=>{f.value.name=t.myBankName,i.addMsgEvent(o.msgType.msg_notify_req_new_bank_card_info,S)})),L((()=>{i.removeMsgEvent(o.msgType.msg_notify_req_bank_name_list,null),i.removeMsgEvent(o.msgType.msg_notify_req_new_bank_card_info,null)})),a({showAddBankModal:()=>{g.value=!0}}),(a,l)=>{const n=u,s=r,i=m,o=p,c=de;return y(),B("div",re,[V(c,{visible:g.value,"onUpdate:visible":l[2]||(l[2]=e=>g.value=e)},{default:M((()=>[x("div",me,[V(o,{"label-position":"top",ref:"formRef",class:""},{default:M((()=>[x("div",pe,[x("span",null,w(z(v)("paymentManagement_page_add_one_bank")),1),x("span",{class:"close_icon",onClick:j})]),V(s,{label:z(v)("addBank_page_pChooseBank")},{default:M((()=>[x("div",ve,[x("div",ge,[h.value.value?(y(),B("span",be,[x("img",{src:`/imgs/bankIcon/bank_logo_${h.value.value}.webp`,alt:h.value.label},null,8,fe)])):T("",!0),x("span",ke,w(h.value.label),1)]),V(n,{bordered:!1,class:"change_btn",onClick:I},{default:M((()=>[P(w(z(v)("deposit_page_changeWay")),1)])),_:1})])])),_:1},8,["label"]),V(s,{label:z(v)("addBank_page_bankCard")},{default:M((()=>[V(i,{modelValue:f.value.cardNo,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value.cardNo=e),modelModifiers:{trim:!0},placeholder:z(v)("paymentManagement_page_chCardNo"),clearable:""},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),V(s,{label:z(v)("addBank_page_name")},{default:M((()=>[V(i,{modelValue:f.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>f.value.name=e),modelModifiers:{trim:!0},disabled:!!t.myBankName,placeholder:z(v)("paymentManagement_page_chName"),clearable:""},null,8,["modelValue","disabled","placeholder"])])),_:1},8,["label"]),x("div",ye,[V(n,{class:"submit_btn weight_5 center pointer",disabled:k.value,block:"",onClick:C},{default:M((()=>[P(w(z(v)("home_page_confirm")),1)])),_:1},8,["disabled"])]),$(x("div",he,[x("div",Me,[xe,x("span",null,w(z(v)("paymentManagement_page_error_msg")),1)])],512),[[R,!(f.value.bank&&f.value.cardNo&&f.value.name)]])])),_:1},512),e.myBankList?.length>0?(y(),B("div",Be,[we,P(" "+w(z(v)("paymentManagement_page_max_bank",{num:e.myBankList?.length||0})),1)])):T("",!0)])])),_:1},8,["visible"]),V(F,{ref_key:"chooseBankModal",ref:b,onSelectBank:A},null,512)])}}}),[["__scopeId","data-v-ef63572a"]]),Ce=e=>(Z("data-v-dab2c39a"),e=e(),D(),e),Ne={class:"content"},Se={class:"bank_list"},je={class:"flex align_center list_item_l"},Ie=["src"],Ae={class:"list_item_c"},Oe={class:"flex space_between list_item_c_top"},qe={class:"list_item_c_bottom"},Ee={class:"flex align_center f_wrap list_item_r"},Le={key:0,class:"flex align_center justify_center"},Ve=["onClick"],ze=["onClick"],Pe=Ce((()=>x("div",{class:"add_icon"},null,-1))),$e={key:1,class:"flex align_center bottom_tip"},Re=Ce((()=>x("span",{class:"gth-icon"},null,-1))),Ze={class:"popup_body"},De={class:"form_card"},Fe={class:"form_container vertical"},Ue={class:"body vertical center"},Ge={class:"submit_btn flex justify_center"},He=A({__name:"index",setup(e){const{t:a}=s.useI18n(),l=O(),n=O(!1),t=O(!1),u=O(),r=O(),m=O(!1),p=O({}),v=O(),f=()=>{m.value=!0;const e=_.req_bank_card_info_list();d.instance.sendRequest(e)},k=e=>{console.log("------99",e),setTimeout((()=>{m.value=!1}),300),r.value=e.cardholder_name||"",t.value=!0,u.value=e.bank_card_info_list.reverse()},C=e=>{let a;e=p.value,m.value=!0,a="del"===v.value?_.req_del_bank_card_info():_.req_set_default_bankcard(),a.bankcard=`${e.bank_id}_${e.account_number}`,d.instance.sendRequest(a)},I=e=>{m.value=!1,n.value=!1,0===e.result?(c.success(a("proxy_page_caoZuo")),f()):c.fail(a("proxy_page_caoZuoFail"))},A=e=>{m.value=!1,n.value=!1,0===e.rlt?(c.success(a("proxy_page_caoZuo")),f()):c.fail(a("proxy_page_caoZuoFail"))},q=e=>e.length<=7?e.replace(/./g,"***"):e.substr(0,3)+"**** ****"+e.substr(-4),$=()=>{l.value.showAddBankModal()};return E((()=>{setTimeout((()=>{f(),i.addMsgEvent(o.msgType.msg_notify_bank_card_info_list,k),i.addMsgEvent(o.msgType.msg_notify_del_bank_card_info,I),i.addMsgEvent(o.msgType.msg_notify_set_default_bankcard,A)}),500)})),L((()=>{i.removeMsgEvent(o.msgType.msg_notify_bank_card_info_list,null),i.removeMsgEvent(o.msgType.msg_notify_del_bank_card_info,null),i.removeMsgEvent(o.msgType.msg_notify_set_default_bankcard,null)})),(e,s)=>(y(),B("div",Ne,[x("div",Se,[(y(!0),B(N,null,S(u.value,((e,l)=>{return y(),B("div",{class:j("flex align_center space_between bank_list_item "+(0===l?"active":"")),key:l},[x("div",je,[x("img",{src:`/imgs/bankIcon/bank_logo_${e.bank_id}.webp`},null,8,Ie)]),x("div",Ae,[x("div",Oe,[x("span",null,w(e.bank_name),1),x("span",null,w((t=r.value,t.substr(0,1)+"**")),1)]),x("div",qe,w(q(e.account_number)),1)]),x("div",Ee,[0===l?(y(),B("span",Le,w(z(a)("paymentManagement_page_default_bank")),1)):(y(),B(N,{key:1},[x("span",{class:"flex align_center justify_center sh_color",onClick:a=>(e=>{v.value="del",n.value=!0,p.value=e,console.log(e)})(e)},w(z(a)("paymentManagement_page_delete")),9,Ve),x("span",{class:"flex align_center justify_center mr_color",onClick:a=>(e=>{v.value="default",n.value=!0,p.value=e})(e)},w(z(a)("paymentManagement_page_set_default")),9,ze)],64))])],2);var t})),128)),u.value?.length<6?(y(),B("div",{key:0,class:"flex f_wrap align_center justify_center bank_list_item add_bank",onClick:$},[Pe,x("div",null,w(z(a)("paymentManagement_page_new_bank")),1)])):T("",!0),u.value?.length>0?(y(),B("div",$e,[Re,P(" "+w(z(a)("paymentManagement_page_max_bank",{num:u.value?.length||0})),1)])):T("",!0)]),V(g,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=e=>n.value=e),title:z(a)("paymentManagement_page_tips")},{default:M((()=>[x("div",Ze,[x("div",De,[x("div",Fe,[x("div",Ue,w("del"===v.value?z(a)("paymentManagement_page_tipContent"):z(a)("paymentManagement_page_set_xw_default")),1)])]),x("div",Ge,[V(b,{disabled:m.value,height:"44px",width:"200px",onClick:C,class:"submit"},{default:M((()=>[P(w(z(a)("home_page_confirm")),1)])),_:1},8,["disabled"])])])])),_:1},8,["visible","title"]),t.value?(y(),h(Te,{key:0,ref_key:"addMyBankModal",ref:l,onGetMyBindBankList:f,myBankName:r.value,myBankList:u.value},null,8,["myBankName","myBankList"])):T("",!0)]))}}),Qe=v(He,[["__scopeId","data-v-dab2c39a"]]);export{Qe as default};